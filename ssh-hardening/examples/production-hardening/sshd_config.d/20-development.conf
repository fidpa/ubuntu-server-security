# Copyright (c) 2025-2026 Marc Allgeier (fidpa)
# SPDX-License-Identifier: MIT
# https://github.com/fidpa/ubuntu-server-security
#
# Development Server SSH Override Configuration
# Purpose: Development/Workstation-specific SSH configuration overrides
# Deployment: /etc/ssh/sshd_config.d/20-development.conf
# Device Role: Development Server, Workstation, Docker Host
#
# Rationale: Development servers need X11 forwarding for remote desktop and development tools

# ═══════════════════════════════════════════════════════════
# X11 Forwarding (Development & Remote Desktop)
# ═══════════════════════════════════════════════════════════

# Allow X11 forwarding (needed for remote GUI applications)
# Override: base config disables this for security
X11Forwarding yes

# X11 display offset
X11DisplayOffset 10

# Use localhost for X11 forwarding (security)
X11UseLocalhost yes

# ═══════════════════════════════════════════════════════════
# TCP Forwarding (Development Feature)
# ═══════════════════════════════════════════════════════════

# Allow TCP forwarding (needed for port forwarding to Docker services)
# Override: base config disables this for security
AllowTcpForwarding yes

# ═══════════════════════════════════════════════════════════
# Development-Specific Settings
# ═══════════════════════════════════════════════════════════

# Agent forwarding (for git operations with SSH keys)
AllowAgentForwarding yes

# ═══════════════════════════════════════════════════════════
# Notes
# ═══════════════════════════════════════════════════════════

# These overrides enable:
# - Remote GUI applications (VS Code Remote, GUI tools)
# - Port forwarding to Docker services (Prometheus, Grafana, databases)
# - Git operations with SSH agent (development workflow)
#
# Security considerations:
# - X11Forwarding: Required for development, but limited to localhost
# - AllowAgentForwarding: Enables git SSH operations
# - AllowTcpForwarding: Required for Docker service access
# - All other hardening from base config remains active
#
# Use cases:
# - X11 apps: ssh -X [USERNAME]@[SERVER_IP] firefox
# - Port forwarding: ssh -L 3000:localhost:3000 [USERNAME]@[SERVER_IP]
# - Git with SSH agent: ssh-add && ssh [USERNAME]@[SERVER_IP] "git pull"
