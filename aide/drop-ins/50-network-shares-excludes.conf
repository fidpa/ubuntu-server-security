# AIDE Drop-in: Network Shares Excludes
# Copyright (c) 2025-2026 Marc Allgeier (fidpa)
# SPDX-License-Identifier: MIT
#
# Network-mounted filesystems excludes for AIDE
# Prevents I/O errors and timeouts from unmounted/stale network shares

# SSHFS mounts (common mount points)
!/mnt/sshfs
!/mnt/remote
!/media/sshfs

# NFS mounts (common mount points)
!/mnt/nfs
!/srv/nfs
!/media/nfs

# CIFS/SMB mounts (Windows shares)
!/mnt/smb
!/mnt/cifs
!/media/windows

# Generic network storage
!/mnt/network
!/mnt/nas
!/srv/nas

# User-specific network mounts
!/home/.*/mnt

# Note: Adjust these patterns to match your actual mount points
# Run 'mount | grep -E "nfs|cifs|sshfs"' to see active network mounts
# 
# WARNING: Scanning unmounted network shares causes:
# - I/O errors (Input/output error)
# - Stale NFS file handle errors  
# - AIDE scan timeouts (can take hours!)
# - Excessive wait times on failed mounts
#
# Best Practice:
# - Exclude ALL network mount points
# - Monitor the mount configuration (/etc/fstab) instead
# - Use separate file integrity checks on the remote systems

# Monitor mount configuration
/etc/fstab Full
