# AIDE Drop-in: Docker Excludes
# Copyright (c) 2025-2026 Marc Allgeier (fidpa)
# SPDX-License-Identifier: MIT
#
# Docker-specific excludes for AIDE
# Prevents false-positives from container runtime state changes

# Docker overlay2 storage (container filesystems)
# Changes on every container start/stop
!/var/lib/docker/overlay2
!/var/lib/docker

# Docker volumes (application data)
# Use VarDir to monitor volume creation/deletion, but not content changes
!/var/lib/docker/volumes/.*/
/var/lib/docker/volumes VarDir

# Container logs (stdout/stderr)
# These grow continuously
!/var/lib/docker/containers/.*/.*\.log$

# Container state (runtime metadata)
!/var/lib/docker/containers/.*/.*-json\.log$
!/var/lib/docker/containers/.*/checkpoints
!/var/lib/docker/containers/.*/shm

# containerd runtime (container daemon)
!/var/lib/containerd/io.containerd.runtime.v2.task
!/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs
!/var/lib/containerd

# Docker BuildKit cache
!/var/lib/docker/buildkit

# Docker network state
!/var/lib/docker/network/files

# Docker plugins
!/var/lib/docker/plugins

# Docker runtime state (sockets, PIDs)
!/run/docker
!/run/containerd

# Still monitor Docker configuration
/etc/docker Full
/var/lib/docker/image VarDir
