# USB Defense System - Kernel Module Blacklist
# https://github.com/fidpa/ubuntu-server-security
#
# Purpose: Block USB mass storage devices at kernel level
# Method: install /bin/false = Blocks ALL loading attempts (boot + hotplug)
#
# What this blocks:
# - USB flash drives
# - External USB hard drives
# - USB card readers
#
# What still works:
# - Keyboards/mice (use usbhid, not usb-storage)
# - Live USB sticks for recovery (boot with own kernel)
# - SSH access (network-based)
#
# Documentation: https://github.com/fidpa/ubuntu-server-security/tree/main/usb-defense

# Block usb-storage (main USB mass storage driver)
install usb-storage /bin/false

# Block uas (USB Attached SCSI - alternative driver)
install uas /bin/false
