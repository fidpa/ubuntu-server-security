# fail2ban VNC Filter
# Copyright (c) 2025-2026 Marc Allgeier (fidpa)
# SPDX-License-Identifier: MIT
# https://github.com/fidpa/ubuntu-server-security
#
# Matches failed authentication attempts in x11vnc, TigerVNC, RealVNC logs
# Supports: x11vnc, TigerVNC, RealVNC

[Definition]

# Regex patterns for VNC authentication failures
failregex = ^.*Client .* \(<HOST>:.*\) .* rejected connection.*$
            ^.*rfbAuthProcessClientMessage: authentication failed from <HOST>.*$
            ^.*authentication failed for <HOST>.*$
            ^.*Connection refused from <HOST>.*$

# Patterns to ignore (legitimate activity)
ignoreregex =
