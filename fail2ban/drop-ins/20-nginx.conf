# fail2ban nginx Protection Jails
# Copyright (c) 2025-2026 Marc Allgeier (fidpa)
# SPDX-License-Identifier: MIT
# https://github.com/fidpa/ubuntu-server-security
#
# nginx HTTP authentication and rate limiting protection
# Target: Nextcloud, WordPress, self-hosted web applications

[nginx-http-auth]
# Protects against HTTP basic auth brute-force attacks
enabled = true
backend = systemd
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log

# Moderate policy: 5 failed logins → 1 hour ban
maxretry = 5
findtime = 600
bantime = 3600

[nginx-limit-req]
# Protects against rate limiting violations (DoS protection)
# Triggers when nginx returns "limiting requests" error
enabled = true
backend = systemd
filter = nginx-limit-req
port = http,https
logpath = /var/log/nginx/error.log

# Aggressive policy: 10 rate limit hits → 10 minute ban
maxretry = 10
findtime = 600
bantime = 600
